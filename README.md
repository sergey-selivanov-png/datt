# Домашнее задание к занятию «Базы данных, их типы»

## ` Сергей Селиванов `

## Задание 1. СУБД
Кейс
Крупная строительная компания, которая также занимается проектированием и девелопментом, решила создать правильную архитектуру для работы с данными. Ниже представлены задачи, которые необходимо решить для каждой предметной области.

Какие типы СУБД, на ваш взгляд, лучше всего подойдут для решения этих задач и почему?

## Ответ:

1.1. Бюджетирование проектов и финансовая аналитика:

Для задач по бюджетированию проектов, формированию финансовых аналитических отчётов и прогнозирования рисков лучше всего подойдут реляционные СУБД (например, PostgreSQL или MySQL). 
Эти СУБД обеспечивают целостность данных, поддерживают ACID-транзакции и имеют четкую структуру с использованием таблиц и связей между ними, что особенно важно для финансовой аналитики.

1.1.* Хеширование стало занимать длительное время, какое API можно использовать для ускорения работы?* 

Для ускорения работы с хешированием можно использовать библиотеку bcrypt или argon2. 
Эти библиотеки оптимизированы для быстрого и безопасного хеширования паролей и могут значительно уменьшить время, затрачиваемое на эту задачу.

1.2. Лендинги и CRM:

Для лендингов и CRM необходимо выбрать NoSQL СУБД, такие как MongoDB. 
Она гибкая, может быстро справляться с изменениями в структуре данных и подходит для работы с большими объемами данных от пользователей. 
В случае, если нужна и реляционная структура, можно рассмотреть использование PostgreSQL с JSONB для хранения динамических данных.

1.2.* Можно ли эту задачу закрыть одной СУБД? И если да, то какой именно СУБД и какой реализацией?*

Да, можно использовать одну СУБД, такую как PostgreSQL, которая поддерживает реляционные данные, а также имеет возможности для работы с неструктурированными данными через тип JSONB. Это позволит интегрировать лендинги и CRM в одной системе.

1.3. База знаний по корпоративным нормам и правилам:

Для создания базы норм и правил, можно использовать ту же СУБД, что и для бюджетирования (например, PostgreSQL).
Эта СУБД имеет простую и понятную структуру, что упрощает управление данными.

1.3.* Можно ли под эту задачу использовать уже существующую СУБД из задач выше и если да, то как лучше это реализовать?* 

Можно создать отдельные схемы в рамках одной СУБД для разных предметных областей — одна схема для бюджетирования, другая для норм и правил. Это позволяет легко управлять данными и поддерживать целостность в рамках одной базы.

1.4. Логистика (формирование маршрутов и распределение курьеров):

Для задач по быстрому формированию маршрутов и распределению курьеров лучше всего подойдёт реляционная СУБД, так как она хорошо обрабатывает сложные связи между таблицами (например, маршруты, курьеры, заказы). PostgreSQL также обеспечивает поддержку географических данных через расширение PostGIS, что может быть полезно для задач логистики.

1.4.* Можно ли к этой СУБД подключить отдел закупок или для них лучше сформировать свою СУБД в связке с СУБД логистов?* 

Можно подключить отдел закупок к той же СУБД, если система будет проектироваться с учетом совместного использования. Создание отдельной схемы для отдела закупок в рамках той же СУБД может улучшить интеграцию между командами.

1.5.* Можно ли все перечисленные выше задачи решить, используя одну СУБД? Если да, то какую именно?*

Да, все перечисленные задачи можно решить, используя одну СУБД. Наиболее подходящим вариантом будет PostgreSQL. 
Эта СУБД позволяет создавать как реляционные модели, так и работать с неструктурированными данными, имеет расширяемость (например, через расширения PostGIS и другие) и может удовлетворить все перечисленные требования по производительности и целостности данных.


## Задание 2. Транзакции

2.1. Пользователь пополняет баланс счёта телефона, распишите пошагово, какие действия должны произойти для того, чтобы транзакция завершилась успешно. Ориентируйтесь на шесть действий.

2.1.* Какие действия должны произойти, если пополнение счёта телефона происходило бы через автоплатёж?

## Ответ:

## 2.1. Пополнение баланса счёта телефона (успешная транзакция):

Инициация транзакции: Пользователь инициирует пополнение баланса телефона через приложение, сайт или другой интерфейс, указывая номер телефона и сумму пополнения. Система проверяет наличие достаточных средств на источнике (например, банковской карте или внутреннем счете пользователя в системе).

Авторизация: Система отправляет запрос в процессинговый центр (например, банка) для авторизации транзакции на указанную сумму. Процессинговый центр проверяет достаточность средств на карте/счете, лимиты и другие параметры безопасности.

Подтверждение авторизации: Процессинговый центр присылает подтверждение (или отклонение) авторизации. Если авторизация отклонена (например, недостаточно средств или превышен лимит), система уведомляет пользователя об ошибке и причинах.

Списание средств: Если авторизация подтверждена, система списывает средства с источника пользователя (например, блокирует сумму на банковской карте, списывает с внутреннего счета).

Зачисление средств: Система отправляет запрос оператору сотовой связи на пополнение баланса указанного номера телефона на указанную сумму. Оператор проверяет номер телефона и доступность сервиса.

Подтверждение зачисления: Оператор сотовой связи подтверждает зачисление средств на баланс телефона. Система уведомляет пользователя об успешном пополнении баланса.

## 2.1.* Автоплатёж (успешная транзакция):

В случае автоплатежа добавляются этапы, связанные с автоматическим запуском и проверкой условий:

Проверка условий автоплатежа: Система (например, банковское приложение или приложение оператора связи) периодически проверяет условия для запуска автоплатежа. Эти условия могут включать достижение определенного порога баланса на телефоне, наступление определенной даты, или комбинацию факторов.

Инициация транзакции (автоматически): Если условия автоплатежа соблюдены, система автоматически инициирует пополнение баланса телефона на предустановленную сумму. Система проверяет наличие достаточных средств на источнике (например, банковской карте или внутреннем счете пользователя в системе).

Авторизация: Система отправляет запрос в процессинговый центр (например, банка) для авторизации транзакции на указанную сумму. Процессинговый центр проверяет достаточность средств на карте/счете, лимиты и другие параметры безопасности. Как правило, для автоплатежей предварительно получается согласие пользователя на списание средств без дополнительной авторизации для каждой транзакции в рамках заданных лимитов и условий.

Подтверждение авторизации: Процессинговый центр присылает подтверждение (или отклонение) авторизации. Если авторизация отклонена, система пытается повторить транзакцию несколько раз (с заданным интервалом) или отправляет уведомление пользователю о проблеме.

Списание средств: Если авторизация подтверждена, система списывает средства с источника пользователя (например, блокирует сумму на банковской карте, списывает с внутреннего счета).

Зачисление средств: Система отправляет запрос оператору сотовой связи на пополнение баланса указанного номера телефона на указанную сумму. Оператор проверяет номер телефона и доступность сервиса. Важно отметить, что в случае автоплатежа, может быть использован механизм Direct Debit, когда оператор связи сам инициирует списание средств со счета пользователя, на основании предварительно полученного согласия.

Подтверждение зачисления: Оператор сотовой связи подтверждает зачисление средств на баланс телефона. Система уведомляет пользователя об успешном пополнении баланса. В случае Direct Debit, система также фиксирует факт списания средств.


## Задание 3. SQL vs NoSQL

3.1. Напишите пять преимуществ SQL-систем по отношению к NoSQL.

3.1.* Какие, на ваш взгляд, преимущества у NewSQL систем перед SQL и NoSQL.

## Ответ:

## Преимущества SQL-систем по отношению к NoSQL:

Структурированность данных: SQL-системы используют строгую структурированную схему данных, что обеспечивает целостность и однозначность. Это позволяет избежать дублирования и несоответствия данных.

ACID-транзакции: SQL-системы обеспечивают поддержку транзакций с принципами ACID (Atomicity, Consistency, Isolation, Durability), что гарантирует надежность операций и защиту данных от сбоев.

Стандарты языка запросов: Язык SQL является общепринятым стандартом для работы с реляционными базами данных. Это облегчает обучение и переход между разными SQL-системами для разработчиков.

Сложные запросы: SQL-системы подходят для выполнения сложных запросов и объединений (JOINs) данных из нескольких таблиц. Это особенно полезно для аналитических и отчетных задач.

Инструменты для администрирования и анализа: SQL-системы часто имеют развитые инструменты для администрирования, мониторинга и анализа производительности, что позволяет системным администраторам эффективно управлять базами данных.

## Преимущества NewSQL перед SQL и NoSQL:

Высокая производительность и масштабируемость: NewSQL системы обеспечивают лучшее масштабирование по сравнению с традиционными SQL-системами, позволяя обрабатывать большие объемы данных и поддерживать высокий уровень производительности при увеличении нагрузки.

Поддержка ACID-транзакций: Подобно SQL-системам, NewSQL системы сохраняют строгие гарантиям ACID, что делает их подходящими для решения задач, требующих надежности и консистентности данных.

Совмещение реляционной модели и NoSQL: NewSQL системы часто объединяют преимущества реляционных данных и гибкости NoSQL, позволяя хранить и обрабатывать как структурированные, так и полуструктурированные данные.

Современные архитектуры: Многие NewSQL базы данных используют распределённые архитектуры, которые обеспечивают более быструю обработку запросов и снижают риск «узких мест» по сравнению с традиционными реляционными системами.

Интеграция с облачными решениями: NewSQL системы часто лучше интегрированы с облачными платформами, что позволяет использовать преимущества облачной инфраструктуры для обеспечения гибкости и масштабируемости.

## Задание 4. Кластеры

Необходимо производить большое количество вычислений при работе с огромным количеством данных, под эту задачу выделено 1000 машин.

На основе какого критерия будете выбирать тип СУБД и какая модель распределённых вычислений здесь справится лучше всего и почему?

## Ответ:

## Критерии выбора типа СУБД:

Тип данных и структура: Важно учитывать структуру данных, с которыми будет работать система. Если данные имеют фиксированную структуру и требуют сложных транзакций, лучше выбрать реляционную СУБД. Если же данные полуструктурированные или неструктурированные, стоит рассмотреть NoSQL СУБД.

Объем данных: С учетом большого объема данных выбираем СУБД, способную эффективно масштабироваться. Например, некоторые NoSQL решения (как Cassandra или MongoDB) лучше справляются с горизонтальным масштабированием и, следовательно, могут обрабатывать огромные объемы информации.

Производительность запросов: Ключевым моментом является скорость обработки и выполнения запросов. Необходимо рассмотреть, как СУБД справляется с большого объема запросов одновременно и как обрабатываются сложные запросы.

Поддержка распределенной архитектуры: Система должна иметь возможность работать в распределенной среде, обеспечивая выгоду от использования кластеров. Это может включать распределенное хранение данных и возможности репликации.

Управление данными и согласованность: Для определенных важных задач может потребоваться строгая согласованность данных. Важно учитывать, как система обрабатывает проблемы, связанные с согласованностью и целостностью.

## Модель распределенных вычеслений и почему:

Для выполнения больших вычислений на 1000 машинах наилучший выбор может быть сделан в пользу модели MapReduce.

MapReduce хорошо подходит для обработки данных в распределенной среде, так как он разделяет задачу на более мелкие задачи, которые могут выполняться параллельно на разных машинах.

Устойчивость к сбоям: В рамках распределенной архитектуры MapReduce может справляться с отказами узлов, просто переназначая задачи на другие работающие машины, что повышает надежность системы.

Интеграция с хранилищами: Многие системы, поддерживающие MapReduce (например, Hadoop), могут работать с различными типами хранилищ данных, включая распределенные файловые системы.

Гибкость: MapReduce можно применять для различных типов задач, включая обработку и анализ больших данных, что делает его универсальным инструментом для анализа данных.
